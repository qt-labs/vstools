<HTML DIR="ltr">
	<HEAD>
		<TITLE>'Qt4GuiClass'</TITLE>
		<META NAME="vs_targetSchema" CONTENT="http://schemas.microsoft.com/intellisense/ie5">
		<LINK ID="LINKURL" REL="stylesheet" HREF="../../1033/styles.css">
		<!--  -->
		<!-- The SYMBOL tag is used to set the default values for the user-defined symbols.-->
		<!--  -->
		<SYMBOL NAME='WIZARD_DIALOG_TITLE' TYPE="text" VALUE='Qt4GuiClass'></SYMBOL>
		<SYMBOL NAME='MEMBER' TYPE="checkbox" VALUE="true"></SYMBOL>
		<SYMBOL NAME='MULTIPLEINHERITANCE' TYPE="checkbox" VALUE="false"></SYMBOL>
		<SYMBOL NAME='MEMBERPOINTER' TYPE="checkbox" VALUE="false"></SYMBOL>
		<SYMBOL NAME='CLASS_NAME' TYPE="text" VALUE=''></SYMBOL>
		<SYMBOL NAME='BASECLASS_NAME' TYPE="text" VALUE='QWidget'></SYMBOL>
		<SYMBOL NAME='CPP_NAME' TYPE="text" VALUE=''></SYMBOL>
		<SYMBOL NAME='H_NAME' TYPE="text" VALUE=''></SYMBOL>
		<SYMBOL NAME='UI_NAME' TYPE="text" VALUE=''></SYMBOL>
		<SYMBOL NAME='LOCATION' TYPE="text" VALUE=''></SYMBOL>
	</HEAD>
	<BODY BGCOLOR="buttonface" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0"
		ONLOAD="InitDocument(document);" ONKEYDOWN="OnKey();" ONKEYPRESS="OnPress();">
		<TABLE CLASS="ONE" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COLGROUP>
				<COL WIDTH="100%">
				<!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
				<TR VALIGN="top">
					<TD HEIGHT="79" WIDTH="100%" COLSPAN="2">
						<TABLE CLASS="TWO" BORDER="0" CELLPADDING="0" CELLSPACING="0">
							<COLGROUP>
								<COL WIDTH="12">
								<COL>
								<COL WIDTH="12">
								<TR>
									<TD VALIGN="top" HEIGHT="12" WIDTH="12">
										&nbsp;
									</TD>
									<TD VALIGN="top" HEIGHT="12">
										&nbsp;
									</TD>
									<TD VALIGN="top" HEIGHT="12" WIDTH="12">
										&nbsp;
									</TD>
									<TD CLASS="IMAGE" VALIGN="bottom" WIDTH="110" ROWSPAN="2">
										<DIV CLASS="SMALLA" ID="Layer0">
											<IMG CLASS="SMALLEST" SRC="../../Images/Qt4GuiClass.gif" WIDTH="63" HEIGHT="63" ALT="" BORDER="0">
										</DIV>
									</TD>
									<TD VALIGN="top" HEIGHT="12" WIDTH="6" ROWSPAN="2">
										&nbsp;
									</TD>
								</TR>
								<TR>
									<TD VALIGN="top" HEIGHT="65" WIDTH="12">
										&nbsp;
									</TD>
									<TD VALIGN="top" HEIGHT="65">
										<H4 CLASS="HEAD" ID="HEAD">Welcome to the Qt4 GUI Class Wizard</H4>
										<P CLASS="SUBHEAD" ID="SUBHEAD">This wizard will add a new Qt4 GUI class to your 
											project. The wizard creates a .h and .cpp file. It also creates a new empty 
											form.</P>
									</TD>
									<TD VALIGN="top" HEIGHT="65" WIDTH="12">
										&nbsp;
									</TD>
								</TR>
								<TR>
									<TD VALIGN="top" CLASS="RULE" COLSPAN="5" HEIGHT="2">
										<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
											<TR VALIGN="top">
												<TD HEIGHT="1" WIDTH="100%" BGCOLOR="buttonshadow"><IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="1" ALT=""></TD>
												<TD HEIGHT="1" WIDTH="1" BGCOLOR="window"><IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="1" ALT=""></TD>
											</TR>
										</TABLE>
									</TD>
								</TR>
						</TABLE>
					</TD>
				</TR>
				<!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
				<!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
				<TR VALIGN="top">
					<TD VALIGN="top" HEIGHT="100%">
						<!--OPEN OF CONTENT AND BUTTON TABLE//-->
						<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
							<COLGROUP>
								<COL WIDTH="100%">
								<TR VALIGN="top">
									<TD HEIGHT="100%">
										<!--OPEN OF CONTENT//-->
										<TABLE CLASS="CONTENT" BORDER="0" CELLPADDING="0" CELLSPACING="0">
											<COLGROUP>
												<COL WIDTH="12">
												<COL WIDTH="185">
												<COL WIDTH="12">
												<COL WIDTH="185">
												<COL WIDTH="12">
												<COL WIDTH="185">
												<COL WIDTH="12">
												<TR>
													<TD vAlign="top" colSpan="7" height="12">&nbsp;
													</TD>
												</TR>
												<TR VALIGN="top">
													<TD vAlign="top" width="12"></TD>
													<TD vAlign="top">Class name:</TD>
													<TD VALIGN="top" colSpan="2">.h file:</TD>
													<TD VALIGN="top" COLSPAN="2">.ui file:</TD>
													<TD VALIGN="top" WIDTH="12">&nbsp;</TD>
												</TR>
												<TR>
													<TD vAlign="top" width="12"></TD>
													<TD vAlign="top"><INPUT id="CLASS_NAME" type="text" name="Text4" onPropertychange="ClassNameChanged();"></TD>
													<TD vAlign="top" colSpan="2"><INPUT id="H_NAME" type="text" name="Text1"></TD>
													<TD vAlign="top" colSpan="2"><INPUT id="UI_NAME" type="text" name="Text3"></TD>
													<TD vAlign="top" width="12"></TD>
												</TR>
												<TR>
													<TD vAlign="top" width="12"></TD>
													<TD vAlign="top">Base class:</TD>
													<TD vAlign="top" colSpan="2">.cpp file:</TD>
													<TD vAlign="top" colSpan="2"></TD>
													<TD vAlign="top" width="12"></TD>
												</TR>
												<TR>
													<TD vAlign="top" width="12"></TD>
													<TD vAlign="top"><INPUT id="BASECLASS_NAME" type="text" name="Text5"></TD>
													<TD vAlign="top" colSpan="2"><INPUT id="CPP_NAME" type="text" name="Text2"></TD>
													<TD vAlign="top" colSpan="2">Ui Class Inclusion as:</TD>
													<TD vAlign="top" width="12"></TD>
												</TR>
												<TR>
													<TD vAlign="top" width="12"></TD>
													<TD vAlign="top" rowspan=4 colspan=3><p id=ERROR_FIELD align=center></p></TD>
													<TD vAlign="top" colSpan="1"></TD>
													<TD vAlign="top" colSpan="2"><INPUT id="MEMBER" type="radio" name="inclusion" checked> member</TD>
													<TD vAlign="top" width="12"></TD>
												</TR>
												<TR>
													<TD vAlign="top" width="12"></TD>
													<TD vAlign="top" colSpan="1"></TD>
												    <TD vAlign="top" colSpan="2"><INPUT id="MULTIPLEINHERITANCE" type="radio" name="inclusion"> multiple Inheritance</TD>
												    <TD vAlign="top" width="12"></TD>
												</TR>
												<TR>
													<TD vAlign="top" width="12"></TD>
													<TD vAlign="top" colSpan="1"></TD>
												    <TD vAlign="top" colSpan="2"><INPUT id="MEMBERPOINTER" type="radio" name="inclusion"> member pointer </TD>
												    <TD vAlign="top" width="12"></TD>
												</TR>
              <TR>
                <TD style="HEIGHT: 20px" vAlign=top width=12></TD>
                <TD style="HEIGHT: 20px" vAlign=top colSpan=1></TD>
                <TD style="HEIGHT: 20px" vAlign=top colSpan=2><INPUT 
                  id=LOWER_CASE type=checkbox CHECKED name=Checkbox2 onpropertychange="LowerCaseChanged();">Lower case 
                  file names</TD>
                <TD style="HEIGHT: 20px" vAlign=top width=12></TD></TR>
												<TR>
                                                    <TD vAlign="top" height="50px">&nbsp;
                                                    </TD>
                                                </TR>
                                                <TR>
                                                    <TD vAlign="top" width="12" style="HEIGHT: 25px"></TD>
                                                    <TD vAlign="top" style="WIDTH: 500px; HEIGHT: 25px" colspan="3">Location: <INPUT id="LOCATION" type="text" name="Text6" style="WIDTH: 330px" size="36"></TD>
                                                    <TD style="HEIGHT: 25px" vAlign="top" colSpan="2"><INPUT id="Button1" type="button" name="button" value="Browse..." onclick="ShowBrowseDialog();">
                                                </TR>
                                                <TR>
                                                    <TD vAlign="top" height="100%">&nbsp;
                                                    </TD>
                                                </TR>
										</TABLE>
										<!--CLOSE OF CONTENT//-->
									</TD>
								</TR>
								<TR VALIGN="bottom">
									<TD HEIGHT="48">
										<!--OPEN OF BUTTON HTML//-->
										<TABLE HEIGHT="48" BORDER="0" CELLPADDING="0" CELLSPACING="0">
											<COLGROUP>
												<COL WIDTH="12">
												<COL>
												<COL WIDTH="75">
												<COL WIDTH="4">
												<COL WIDTH="75">
												<COL WIDTH="4">
												<COL WIDTH="75">
												<COL WIDTH="12">
												<TR>
													<TD VALIGN="top" CLASS="RULE" COLSPAN="8" HEIGHT="2">
														<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
															<TR VALIGN="top">
																<TD HEIGHT="1" WIDTH="100%" BGCOLOR="buttonshadow"><IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="1" ALT=""></TD>
																<TD HEIGHT="1" WIDTH="1" BGCOLOR="window"><IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="1" ALT=""></TD>
															</TR>
														</TABLE>
													</TD>
												</TR>
												<TR>
													<TD VALIGN="top" HEIGHT="11" COLSPAN="8">
														&nbsp;
													</TD>
												</TR>
												<TR>
													<TD VALIGN="middle" HEIGHT="23" WIDTH="12">
														&nbsp;
													</TD>
													<TD VALIGN="top" HEIGHT="23">
														&nbsp;
													</TD>
													<TD VALIGN="middle" HEIGHT="23" WIDTH="75">
														<BUTTON CLASS="BUTTONS" ID="FinishBtn" ACCESSKEY="F" onClick="OnFinish(document);" type="button">
															<U>F</U>inish</BUTTON>
													</TD>
													<TD VALIGN="middle" HEIGHT="23" WIDTH="4">
														&nbsp;
													</TD>
													<TD VALIGN="middle" HEIGHT="23" WIDTH="75">
														<BUTTON CLASS="BUTTONS" ID="CancelBtn" ACCESSKEY="C" onClick="window.external.Finish(document, 'cancel');"
															type="button"><U>C</U>ancel</BUTTON>
													</TD>
													<TD VALIGN="middle" HEIGHT="23" WIDTH="4">
														&nbsp;
													</TD>
													<TD VALIGN="middle" HEIGHT="23" WIDTH="75">
														<BUTTON CLASS="BUTTONS" ID="HelpBtn" ACCESSKEY="H" onClick="window.external.OnHelp('vc.appwiz.custom.overview');"
															type="button" disabled><U>H</U>elp</BUTTON>
													</TD>
													<TD VALIGN="middle" HEIGHT="23" WIDTH="12">
														&nbsp;
													</TD>
												</TR>
												<TR>
													<TD VALIGN="top" HEIGHT="12" COLSPAN="8">
														&nbsp;
													</TD>
												</TR>
										</TABLE>
										<!--CLOSE OF BUTTON HTML//-->
									</TD>
								</TR>
						</TABLE>
						<!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
					</TD>
				</TR>
		</TABLE>
		
    </BODY>
</HTML>

		<SCRIPT LANGUAGE="JSCRIPT">
var QtEngine;
var dte;
// Called when the class name changes
function ClassNameChanged()
{
	LowerCaseChanged();
}

function LowerCaseChanged()
{
    var strClassName = CLASS_NAME.value;
    var idx = strClassName.lastIndexOf('::');
    if (idx >= 0)
        strClassName = strClassName.substr(idx+2);

    if (LOWER_CASE.checked) {
        strClassName = strClassName.toLowerCase();
    }

    H_NAME.value = strClassName + ".h";
    CPP_NAME.value = strClassName + ".cpp";
    UI_NAME.value = strClassName + ".ui";
}

function ShowBrowseDialog()
{	
	LOCATION.value = QtEngine.ShowOpenFolderDialog(LOCATION.value);    
}

function IsValid()
{
	var testVal = CLASS_NAME.value;
    var idx = testVal.lastIndexOf('::');
    if (idx >= 0)
        testVal = testVal.substr(idx+2);

	if (!window.external.dte.VCLanguageManager.ValidateIdentifier(testVal) ||
			window.external.dte.VCLanguageManager.IsReservedName(testVal))
	{
		window.external.ReportError("Not a valid class name");
		CLASS_NAME.focus();
		return false;
	}

	testVal = BASECLASS_NAME.value;
	if (!window.external.dte.VCLanguageManager.ValidateIdentifier(testVal) ||
			window.external.dte.VCLanguageManager.IsReservedName(testVal))
	{
		window.external.ReportError("Not a valid base class name");
		BASECLASS_NAME.focus();
		return false;
	}
	
	testVal = H_NAME.value;
	if (!window.external.dte.VCLanguageManager.ValidateFileName(testVal))
	{
		window.external.ReportError("Not a valid .h file name");
		H_NAME.focus();
		return false;
	}

	if (window.external.ProjectObject.Object.Files.Item(testVal))
	{
		window.external.ReportError(".h File already exists");
		H_NAME.focus();
		return false;
	}

	testVal = UI_NAME.value;
	testVal = testVal.toLowerCase().replace(".h",".x"); // don't validate .h files...
	testVal = testVal.replace(".ui",".h");
	if (!window.external.dte.VCLanguageManager.ValidateFileName(testVal))
	{
		window.external.ReportError("Not a valid .ui file name");
		UI_NAME.focus();
		return false;
	}

	if (window.external.ProjectObject.Object.Files.Item(testVal))
	{
		window.external.ReportError(".ui File already exists");
		UI_NAME.focus();
		return false;
	}

	testVal = CPP_NAME.value;
	if (!window.external.dte.VCLanguageManager.ValidateFileName(testVal))
	{
		window.external.ReportError("Not a valid .cpp file name");
		CPP_NAME.focus();
		return false;
	}

	if (window.external.ProjectObject.Object.Files.Item(testVal))
	{
		window.external.ReportError(".cpp File already exists");
		CPP_NAME.focus();
		return false;
	}
	
	testVal = LOCATION.value;
	if (testVal.length == 0) {
	    window.external.ReportError("Not a valid location directory!");
		LOCATION.focus();
		return false;
	}
	
	return true;
}

// This is an example of a function which initializes the page
//
function InitDocument(document)
{
	setDirection();
	
	dte = window.external.dte;
	if (!dte) {
	    window.external.ReportError("Cannot find automation object!");
	    return false;
	}
	var version = dte.version;
    if (version == "8.0")
        QtEngine = new ActiveXObject("Nokia.QtProjectEngine80");
	else if (version == "9.0")
        QtEngine = new ActiveXObject("Nokia.QtProjectEngine90");
	else if (version == "10.0")
        QtEngine = new ActiveXObject("Nokia.QtProjectEngine100");
    else {
        window.external.ReportError("Cannot instantiate QtProjectEngine object!");
        return false;
    }
    
    if (window.external.FindSymbol('DOCUMENT_FIRST_LOAD'))
	{
		// This function sets the default symbols based 
		// on the values specified in the SYMBOL tags above
		//
		window.external.SetDefaults(document);
	}

	// Load the document and initialize the controls 
	// with the appropriate symbol values
	//
	InitControls();
	window.external.Load(document);
	var projFile = window.external.ProjectObject.FullName;
    var i = projFile.lastIndexOf("\\");
    LOCATION.value = projFile.substring(0, i);
}

function InitControls()
{
    if (!QtEngine.IsSelectedProjectQt(dte))
    {
	DisableControls();
	ERROR_FIELD.innerHTML="<font size=3 color=#990000><BR>It is impossible to add a QtGuiClass to the current project"
		+ ", as it was not created using Qt4VSAddin.</font>";
    }
}

function DisableControls()
{
        FinishBtn.disabled=true;
	CLASS_NAME.disabled=true;
	BASECLASS_NAME.disabled=true;
	CPP_NAME.disabled=true;
	H_NAME.disabled=true;
	UI_NAME.disabled=true;
	LOCATION.disabled=true;
	MEMBER.disabled=true;
	MULTIPLEINHERITANCE.disabled=true;
	MEMBERPOINTER.disabled=true;
	LOWER_CASE.disabled=true;
	Button1.disabled=true;
}

// If the wizard has more than 1 page, this 
// function will browse to the page specified
//
function Next(document, linkto)
{
	window.external.Next(document, linkto);
}

// This is an example of a function which
// gets called when the user clicks on 'Finish'
//
function OnFinish(document)
{
	if(!IsValid())
		return;
		
	OnWizFinish(document);
}

		</SCRIPT>
		<SCRIPT ID="INCLUDE_SCRIPT" LANGUAGE="JSCRIPT"></SCRIPT>
		<SCRIPT ID="INCLUDE_COMMON" LANGUAGE="JSCRIPT"></SCRIPT>
		<!-- 
Common.js is a script file which contains the helper functions 
used by the wizards.  Include this line if you want to
call these functions from your html scripts.
//-->
<SCRIPT>
	var strPath = window.external.FindSymbol("PRODUCT_INSTALLATION_DIR");
	strPath += "VCWizards/";
	strPath += window.external.GetHostLocale();

    // verify if the locale folder really exists
    var fso = new ActiveXObject("Scripting.FileSystemObject");
    var found = fso.FolderExists(strPath)
    if (found == false) {
        strPath = window.external.FindSymbol("PRODUCT_INSTALLATION_DIR");
	    strPath += "VCWizards/";
	    var folder = fso.GetFolder(strPath);
        for (subfolders = new Enumerator(folder.SubFolders); !subfolders.atEnd(); subfolders.moveNext())
        {
            for (files = new Enumerator(subfolders.item().files); !files.atEnd(); files.moveNext()) {
                if (files.item().name.toLowerCase().localeCompare("common.js") == 0) {
                    found = true;
                    strPath += subfolders.item().name;
                    break;              
                }
            }
            if (found == true)
                break;
        }
	}

    var strScriptPath = strPath + "/Script.js";
    var strCommonPath = strPath + "/Common.js";
    document.scripts("INCLUDE_SCRIPT").src = strScriptPath;
    document.scripts("INCLUDE_COMMON").src = strCommonPath;
</SCRIPT>
